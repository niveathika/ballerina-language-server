{
  "start": {
    "line": 12,
    "offset": 4
  },
  "end": {
    "line": 16,
    "offset": 5
  },
  "source": "agent_with_backticks_in_system_prompt.bal",
  "description": "Tests a simple diagram flow",
  "diagram": {
    "fileName": "agent_with_backticks_in_system_prompt.bal",
    "nodes": [
      {
        "id": "47063",
        "metadata": {
          "label": "Start",
          "data": {
            "kind": "AI Chat Agent",
            "label": "chat",
            "isServiceFunction": true,
            "accessor": "post",
            "parameters": [
              "@http:Payload ai:ChatReqMessage request"
            ],
            "return": "ai:ChatRespMessage|error"
          }
        },
        "codedata": {
          "node": "EVENT_START",
          "lineRange": {
            "fileName": "agent_with_backticks_in_system_prompt.bal",
            "startLine": {
              "line": 12,
              "offset": 106
            },
            "endLine": {
              "line": 16,
              "offset": 5
            }
          },
          "sourceCode": "resource function post chat(@http:Payload ai:ChatReqMessage request) returns ai:ChatRespMessage|error {\n\n        string stringResult = check _WorkflowAgentAgent.run(request.message, request.sessionId);\n        return {message: stringResult};\n    }"
        },
        "returning": false,
        "flags": 0
      },
      {
        "id": "45976",
        "metadata": {
          "label": "run",
          "description": "Executes the agent for a given user query.\n",
          "icon": "https://bcentral-packageicons.azureedge.net/images/ballerina_ai_1.7.0.png",
          "data": {
            "tools": [],
            "agent": {
              "systemPrompt": "{role: string `Role with ${\"`\"}backticks${\"`\"}`, instructions: string `Instructions with ${\"`\"}backticks${\"`\"}`}",
              "instructions": "Instructions with `backticks`",
              "role": "Role with `backticks`",
              "scope": "Global",
              "model": "_WorkflowAgentModel",
              "tools": "[]"
            },
            "model": {
              "name": "_WorkflowAgentModel",
              "path": "https://bcentral-packageicons.azureedge.net/images/._._0.0.0.png",
              "type": "Wso2ModelProvider"
            }
          }
        },
        "codedata": {
          "node": "AGENT_CALL",
          "org": "ballerina",
          "module": "ai",
          "packageName": "ai",
          "object": "Agent",
          "symbol": "run",
          "version": "1.7.0",
          "lineRange": {
            "fileName": "agent_with_backticks_in_system_prompt.bal",
            "startLine": {
              "line": 14,
              "offset": 8
            },
            "endLine": {
              "line": 14,
              "offset": 96
            }
          },
          "sourceCode": "string stringResult = check _WorkflowAgentAgent.run(request.message, request.sessionId);",
          "data": {
            "agentCodedata": {
              "node": "AGENT",
              "org": "ballerina",
              "module": "ai",
              "packageName": "ai",
              "object": "Agent",
              "symbol": "init",
              "version": "1.7.0",
              "lineRange": {
                "fileName": "agent_with_backticks_in_system_prompt.bal",
                "startLine": {
                  "line": 4,
                  "offset": 0
                },
                "endLine": {
                  "line": 7,
                  "offset": 2
                }
              },
              "sourceCode": "final ai:Agent _WorkflowAgentAgent = check new (systemPrompt = {role: string `Role with ${\"`\"}backticks${\"`\"}`, instructions: string `Instructions with ${\"`\"}backticks${\"`\"}`},\n    model = _WorkflowAgentModel,\n    tools = []\n);",
              "isNew": false,
              "data": {
                "scope": "Global"
              }
            }
          }
        },
        "returning": false,
        "properties": {
          "systemPrompt": {
            "metadata": {
              "label": "System Prompt",
              "description": "The system prompt assigned to the agent"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "ai:SystemPrompt",
            "value": "{role: string `Role with ${\"`\"}backticks${\"`\"}`, instructions: string `Instructions with ${\"`\"}backticks${\"`\"}`}",
            "placeholder": "{role: \"\", instructions: \"\"}",
            "optional": false,
            "editable": true,
            "advanced": false,
            "hidden": true,
            "codedata": {
              "kind": "INCLUDED_FIELD"
            },
            "defaultValue": "{role: \"\", instructions: \"\"}"
          },
          "model": {
            "metadata": {
              "label": "Model",
              "description": "The model used by the agent"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "ai:ModelProvider",
            "value": "_WorkflowAgentModel",
            "placeholder": "object {}",
            "optional": false,
            "editable": true,
            "advanced": false,
            "hidden": true,
            "codedata": {
              "kind": "INCLUDED_FIELD"
            },
            "defaultValue": "object {}"
          },
          "tools": {
            "metadata": {
              "label": "Tools",
              "description": "The tools available for the agent"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "(ai:BaseToolKit|ai:ToolConfig|ai:FunctionTool)[]",
            "value": "[]",
            "placeholder": "[]",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": true,
            "codedata": {
              "kind": "INCLUDED_FIELD"
            },
            "defaultValue": "[]"
          },
          "maxIter": {
            "metadata": {
              "label": "Maximum Iterations",
              "description": "The maximum number of iterations the agent performs to complete the task.\nBy default, it is set to the number of tools + 1."
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "\"INFER_TOOL_COUNT\"|int",
            "placeholder": "\"INFER_TOOL_COUNT\"",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": false,
            "codedata": {
              "kind": "INCLUDED_FIELD"
            },
            "defaultValue": "\"INFER_TOOL_COUNT\""
          },
          "verbose": {
            "metadata": {
              "label": "Verbose",
              "description": "Specifies whether verbose logging is enabled"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "boolean",
            "placeholder": "false",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": false,
            "codedata": {
              "kind": "INCLUDED_FIELD"
            },
            "defaultValue": "false"
          },
          "memory": {
            "metadata": {
              "label": "Memory",
              "description": "The memory used by the agent to store and manage conversation history.\nDefaults to use an in-memory message store that trims on overflow, if unspecified."
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "ai:Memory|()",
            "placeholder": "()",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": true,
            "codedata": {
              "kind": "INCLUDED_FIELD"
            },
            "defaultValue": "()"
          },
          "type": {
            "metadata": {
              "label": "Variable Type",
              "description": "Type of the variable"
            },
            "valueType": "TYPE",
            "value": "string",
            "placeholder": "var",
            "optional": false,
            "editable": true,
            "advanced": false,
            "hidden": false,
            "codedata": {}
          },
          "variable": {
            "metadata": {
              "label": "Variable Name",
              "description": "Name of the variable"
            },
            "valueType": "IDENTIFIER",
            "value": "stringResult",
            "optional": false,
            "editable": false,
            "advanced": false,
            "hidden": false,
            "codedata": {
              "lineRange": {
                "fileName": "agent_with_backticks_in_system_prompt.bal",
                "startLine": {
                  "line": 14,
                  "offset": 15
                },
                "endLine": {
                  "line": 14,
                  "offset": 27
                }
              }
            }
          },
          "checkError": {
            "metadata": {
              "label": "Check Error",
              "description": "Trigger error flow"
            },
            "valueType": "FLAG",
            "value": true,
            "optional": false,
            "editable": true,
            "advanced": true,
            "hidden": true
          },
          "scope": {
            "metadata": {
              "label": "Connection Scope",
              "description": "Scope of the connection, Global or Local"
            },
            "valueType": "ENUM",
            "value": "Global",
            "optional": false,
            "editable": true,
            "advanced": true,
            "hidden": true,
            "codedata": {
              "kind": ""
            }
          },
          "role": {
            "metadata": {
              "label": "Role",
              "description": "Define the agent's primary function"
            },
            "valueType": "STRING",
            "value": "Role with `backticks`",
            "placeholder": "e.g., Customer Support Assistant, Sales Advisor, Data Analyst",
            "optional": true,
            "editable": true,
            "advanced": false,
            "hidden": false,
            "codedata": {
              "kind": "REQUIRED"
            },
            "defaultValue": ""
          },
          "instructions": {
            "metadata": {
              "label": "Instructions",
              "description": "Detailed instructions for the agent"
            },
            "valueType": "STRING",
            "value": "Instructions with `backticks`",
            "placeholder": "e.g., You are a friendly assistant. Your goal is to...",
            "optional": true,
            "editable": true,
            "advanced": false,
            "hidden": false,
            "codedata": {
              "kind": "REQUIRED"
            },
            "defaultValue": ""
          },
          "connection": {
            "metadata": {
              "label": "Object",
              "description": "The object which you want to call the method on"
            },
            "valueType": "EXPRESSION",
            "value": "_WorkflowAgentAgent",
            "optional": false,
            "editable": false,
            "advanced": false,
            "hidden": false
          },
          "query": {
            "metadata": {
              "label": "Query",
              "description": "The natural language input provided to the agent"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "string",
            "value": "request.message",
            "placeholder": "\"\"",
            "optional": false,
            "editable": true,
            "advanced": false,
            "hidden": false,
            "codedata": {
              "kind": "REQUIRED",
              "originalName": "query"
            },
            "typeMembers": [
              {
                "type": "string",
                "packageInfo": "",
                "packageName": "",
                "kind": "BASIC_TYPE",
                "selected": true
              }
            ]
          },
          "sessionId": {
            "metadata": {
              "label": "Session ID",
              "description": "The ID associated with the agent memory"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "string",
            "value": "request.sessionId",
            "placeholder": "\"\"",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": false,
            "codedata": {
              "kind": "DEFAULTABLE",
              "originalName": "sessionId"
            },
            "typeMembers": [
              {
                "type": "string",
                "packageInfo": "",
                "packageName": "",
                "kind": "BASIC_TYPE",
                "selected": true
              }
            ],
            "defaultValue": "\"\""
          },
          "context": {
            "metadata": {
              "label": "Context",
              "description": "The additional context that can be used during agent tool execution"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "ai:Context",
            "placeholder": "new ()",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": false,
            "codedata": {
              "kind": "DEFAULTABLE",
              "originalName": "context"
            },
            "typeMembers": [
              {
                "type": "Context",
                "packageInfo": "ballerina:ai:1.7.0",
                "packageName": "ai",
                "kind": "OBJECT_TYPE",
                "selected": false
              }
            ],
            "defaultValue": "new ()"
          }
        },
        "flags": 1
      },
      {
        "id": "46911",
        "metadata": {
          "label": "Return",
          "description": "Value of '{message: stringResult}'"
        },
        "codedata": {
          "node": "RETURN",
          "lineRange": {
            "fileName": "agent_with_backticks_in_system_prompt.bal",
            "startLine": {
              "line": 15,
              "offset": 8
            },
            "endLine": {
              "line": 15,
              "offset": 39
            }
          },
          "sourceCode": "return {message: stringResult};"
        },
        "returning": true,
        "properties": {
          "expression": {
            "metadata": {
              "label": "Expression",
              "description": "Return value"
            },
            "valueType": "ACTION_OR_EXPRESSION",
            "value": "{message: stringResult}",
            "optional": false,
            "editable": true,
            "advanced": false,
            "hidden": false
          }
        },
        "flags": 0
      }
    ],
    "connections": [
      {
        "id": "35807",
        "metadata": {
          "label": "Agent",
          "description": "Represents an agent.",
          "icon": "https://bcentral-packageicons.azureedge.net/images/ballerina_ai_1.7.0.png"
        },
        "codedata": {
          "node": "AGENT",
          "org": "ballerina",
          "module": "ai",
          "object": "Agent",
          "symbol": "init",
          "lineRange": {
            "fileName": "agent_with_backticks_in_system_prompt.bal",
            "startLine": {
              "line": 4,
              "offset": 0
            },
            "endLine": {
              "line": 7,
              "offset": 2
            }
          },
          "sourceCode": "final ai:Agent _WorkflowAgentAgent = check new (systemPrompt = {role: string `Role with ${\"`\"}backticks${\"`\"}`, instructions: string `Instructions with ${\"`\"}backticks${\"`\"}`},\n    model = _WorkflowAgentModel,\n    tools = []\n);"
        },
        "returning": false,
        "properties": {
          "systemPrompt": {
            "metadata": {
              "label": "System Prompt",
              "description": "The system prompt assigned to the agent"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "ai:SystemPrompt",
            "value": "{role: string `Role with ${\"`\"}backticks${\"`\"}`, instructions: string `Instructions with ${\"`\"}backticks${\"`\"}`}",
            "placeholder": "{role: \"\", instructions: \"\"}",
            "optional": false,
            "editable": true,
            "advanced": false,
            "hidden": false,
            "codedata": {
              "kind": "INCLUDED_FIELD",
              "originalName": "systemPrompt"
            },
            "typeMembers": [
              {
                "type": "SystemPrompt",
                "packageInfo": "ballerina:ai:1.7.0",
                "packageName": "ai",
                "kind": "RECORD_TYPE",
                "selected": true
              }
            ],
            "defaultValue": "{role: \"\", instructions: \"\"}"
          },
          "model": {
            "metadata": {
              "label": "Model",
              "description": "The model used by the agent"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "ai:ModelProvider",
            "value": "_WorkflowAgentModel",
            "placeholder": "object {}",
            "optional": false,
            "editable": true,
            "advanced": false,
            "hidden": false,
            "codedata": {
              "kind": "INCLUDED_FIELD",
              "originalName": "model"
            },
            "typeMembers": [
              {
                "type": "ModelProvider",
                "packageInfo": "ballerina:ai:1.7.0",
                "packageName": "ai",
                "kind": "OBJECT_TYPE",
                "selected": false
              }
            ],
            "defaultValue": "object {}"
          },
          "tools": {
            "metadata": {
              "label": "Tools",
              "description": "The tools available for the agent"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "(ai:BaseToolKit|ai:ToolConfig|ai:FunctionTool)[]",
            "value": "[]",
            "placeholder": "[]",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": false,
            "codedata": {
              "kind": "INCLUDED_FIELD",
              "originalName": "tools"
            },
            "typeMembers": [
              {
                "type": "BaseToolKit|ai",
                "packageInfo": "",
                "packageName": "",
                "kind": "ARRAY_TYPE",
                "selected": false
              }
            ],
            "defaultValue": "[]"
          },
          "maxIter": {
            "metadata": {
              "label": "Maximum Iterations",
              "description": "The maximum number of iterations the agent performs to complete the task.\nBy default, it is set to the number of tools + 1."
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "\"INFER_TOOL_COUNT\"|int",
            "placeholder": "\"INFER_TOOL_COUNT\"",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": false,
            "codedata": {
              "kind": "INCLUDED_FIELD",
              "originalName": "maxIter"
            },
            "typeMembers": [
              {
                "type": "\"INFER_TOOL_COUNT\"",
                "packageInfo": "",
                "packageName": "",
                "kind": "BASIC_TYPE",
                "selected": false
              },
              {
                "type": "int",
                "packageInfo": "",
                "packageName": "",
                "kind": "BASIC_TYPE",
                "selected": false
              }
            ],
            "defaultValue": "\"INFER_TOOL_COUNT\""
          },
          "verbose": {
            "metadata": {
              "label": "Verbose",
              "description": "Specifies whether verbose logging is enabled"
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "boolean",
            "placeholder": "false",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": false,
            "codedata": {
              "kind": "INCLUDED_FIELD",
              "originalName": "verbose"
            },
            "typeMembers": [
              {
                "type": "boolean",
                "packageInfo": "",
                "packageName": "",
                "kind": "BASIC_TYPE",
                "selected": false
              }
            ],
            "defaultValue": "false"
          },
          "memory": {
            "metadata": {
              "label": "Memory",
              "description": "The memory used by the agent to store and manage conversation history.\nDefaults to use an in-memory message store that trims on overflow, if unspecified."
            },
            "valueType": "EXPRESSION",
            "valueTypeConstraint": "ai:Memory|()",
            "placeholder": "()",
            "optional": true,
            "editable": true,
            "advanced": true,
            "hidden": false,
            "codedata": {
              "kind": "INCLUDED_FIELD",
              "originalName": "memory"
            },
            "typeMembers": [
              {
                "type": "Memory",
                "packageInfo": "ballerina:ai:1.7.0",
                "packageName": "ai",
                "kind": "OBJECT_TYPE",
                "selected": false
              },
              {
                "type": "()",
                "packageInfo": "",
                "packageName": "",
                "kind": "BASIC_TYPE",
                "selected": false
              }
            ],
            "defaultValue": "()"
          },
          "checkError": {
            "metadata": {
              "label": "Check Error",
              "description": "Terminate on error"
            },
            "valueType": "FLAG",
            "value": true,
            "optional": false,
            "editable": false,
            "advanced": true,
            "hidden": true
          },
          "scope": {
            "metadata": {
              "label": "Connection Scope",
              "description": "Scope of the connection, Global or Local"
            },
            "valueType": "ENUM",
            "value": "Global",
            "optional": false,
            "editable": true,
            "advanced": true,
            "hidden": true
          },
          "variable": {
            "metadata": {
              "label": "Variable Name",
              "description": "Name of the variable"
            },
            "valueType": "IDENTIFIER",
            "value": "_WorkflowAgentAgent",
            "optional": false,
            "editable": false,
            "advanced": false,
            "hidden": false,
            "codedata": {
              "lineRange": {
                "fileName": "agent_with_backticks_in_system_prompt.bal",
                "startLine": {
                  "line": 4,
                  "offset": 15
                },
                "endLine": {
                  "line": 4,
                  "offset": 34
                }
              }
            }
          },
          "type": {
            "metadata": {
              "label": "Variable Type",
              "description": "Type of the variable"
            },
            "valueType": "TYPE",
            "value": "ai:Agent",
            "placeholder": "var",
            "optional": false,
            "editable": true,
            "advanced": false,
            "hidden": false,
            "codedata": {}
          }
        },
        "flags": 1
      },
      {
        "id": "34804",
        "metadata": {
          "label": "getDefaultModelProvider",
          "description": "Creates a default model provider based on the provided `wso2ProviderConfig`.",
          "icon": "https://bcentral-packageicons.azureedge.net/images/ballerina_ai_1.7.0.png"
        },
        "codedata": {
          "node": "FUNCTION_CALL",
          "org": "ballerina",
          "module": "ai",
          "packageName": "ai",
          "symbol": "getDefaultModelProvider",
          "version": "1.7.0",
          "lineRange": {
            "fileName": "agent_with_backticks_in_system_prompt.bal",
            "startLine": {
              "line": 3,
              "offset": 0
            },
            "endLine": {
              "line": 3,
              "offset": 84
            }
          },
          "sourceCode": "final ai:Wso2ModelProvider _WorkflowAgentModel = check ai:getDefaultModelProvider();"
        },
        "returning": false,
        "properties": {
          "checkError": {
            "metadata": {
              "label": "Check Error",
              "description": "Trigger error flow"
            },
            "valueType": "FLAG",
            "value": true,
            "optional": false,
            "editable": true,
            "advanced": true,
            "hidden": true
          },
          "variable": {
            "metadata": {
              "label": "Result",
              "description": "Name of the result variable"
            },
            "valueType": "IDENTIFIER",
            "value": "_WorkflowAgentModel",
            "optional": false,
            "editable": false,
            "advanced": false,
            "hidden": false,
            "codedata": {
              "lineRange": {
                "fileName": "agent_with_backticks_in_system_prompt.bal",
                "startLine": {
                  "line": 3,
                  "offset": 27
                },
                "endLine": {
                  "line": 3,
                  "offset": 46
                }
              }
            }
          },
          "type": {
            "metadata": {
              "label": "Result Type",
              "description": "Type of the variable"
            },
            "valueType": "TYPE",
            "value": "ai:Wso2ModelProvider",
            "placeholder": "var",
            "optional": false,
            "editable": false,
            "advanced": false,
            "hidden": false,
            "codedata": {}
          }
        },
        "flags": 1
      }
    ]
  }
}
